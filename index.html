<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Forumate</title>
<style>
body{margin:0;font-family:'Segoe UI',Tahoma,sans-serif;background:url('wallpaper.png') no-repeat center center fixed;background-size:cover;color:#fff;}
body::before{content:"";position:fixed;top:0;left:0;width:100%;height:100%;background: rgba(0,0,0,0.4);z-index:-1;}

/* Header circular */
header{position:fixed;top:10px;left:50%;transform:translateX(-50%);width:90px;height:90px;background: rgba(66,103,178,0.7);backdrop-filter: blur(12px);border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:16px;font-weight:bold;border:2px solid rgba(255,255,255,0.3);z-index:1000;}

/* Admin button */
#adminBtn{position:absolute;top:-5px;right:-5px;width:30px;height:30px;border-radius:50%;background: rgba(244,67,54,0.85);color:white;font-weight:bold;font-size:16px;border:none;cursor:pointer;}

/* Sidebar */
#sidebar{position:fixed;left:-250px;top:0;width:250px;height:100%;background: rgba(50,50,50,0.9);backdrop-filter:blur(12px);padding:20px;transition:0.3s;z-index:1010;}
#sidebar button{width:100%;margin:8px 0;padding:10px;border:none;border-radius:8px;background: rgba(66,103,178,0.8);color:white;cursor:pointer;}
#sidebar button:hover{background: rgba(66,103,178,1);}
#sidebar .closeBtn{position:absolute;top:10px;right:10px;font-size:20px;cursor:pointer;background:none;border:none;color:white;}

/* Hamburger */
#hamburger{position:fixed;top:15px;left:15px;font-size:24px;cursor:pointer;z-index:1020;}

/* Main forum */
main{max-width:700px;margin:140px auto 30px;padding:0 15px;transition:margin-left 0.3s;}
input, textarea{width:100%;padding:12px;margin:8px 0;border-radius:12px;border:1px solid rgba(255,255,255,0.3);background: rgba(255,255,255,0.2);color:#fff;font-size:16px;box-sizing:border-box;backdrop-filter:blur(10px);resize:none;}
input::placeholder, textarea::placeholder{color: rgba(255,255,255,0.7);}
#postBtn, #reportBugBtn{width:100%;padding:12px;border-radius:12px;border:none;background: rgba(66,103,178,0.8);color:#fff;font-size:16px;cursor:pointer;margin-bottom:10px;}
#postBtn:hover, #reportBugBtn:hover{background: rgba(66,103,178,1);}
.post{background: rgba(255,255,255,0.15);backdrop-filter: blur(10px);border-radius:12px;padding:15px 20px;margin-bottom:12px;border:1px solid rgba(255,255,255,0.2);word-wrap: break-word;opacity:0;animation:fadeIn 0.5s forwards;}
.post img{max-width:100%;border-radius:10px;margin-top:8px;}
.post.pinned{border:2px solid gold;background: rgba(255,215,0,0.15);}
.post .name.owner{color:red;font-weight:bold;}
.postMenuBtn{float:right;cursor:pointer;color:#ccc;font-weight:bold;}
#backBtn{display:none;margin-bottom:10px;cursor:pointer;color:#fff;font-weight:bold;background:none;border:none;font-size:16px;}
/* Login popup */
#loginPopup{display:flex;justify-content:center;align-items:center;position:fixed;top:0;left:0;width:100%;height:100%;background: rgba(0,0,0,0.6);z-index:2000;}
#loginPopup div{background: rgba(50,50,50,0.9); backdrop-filter: blur(12px); padding:20px; border-radius:12px; display:flex; flex-direction:column; min-width:250px;}
#loginPopup input{margin:5px 0; padding:10px; border-radius:10px; border:none; font-size:14px;}
#loginPopup .closeBtn{align-self:flex-end;font-size:18px;cursor:pointer;background:none;border:none;color:white;margin-bottom:5px;}
@keyframes fadeIn{from{opacity:0;} to{opacity:1;}}
@media(max-width:768px){main{margin-top:110px;} input,textarea,#postBtn,#sidebar button,#reportBugBtn{font-size:14px;padding:10px;} header{width:70px;height:70px;font-size:14px;} #adminBtn{width:28px;height:28px;font-size:14px;top:-4px;right:-4px;}}
@media(max-width:480px){main{margin-top:90px;} input,textarea,#postBtn,#sidebar button,#reportBugBtn{font-size:13px;padding:8px;} header{width:60px;height:60px;font-size:12px;} #adminBtn{width:25px;height:25px;font-size:12px;top:-3px;right:-3px;}}
</style>
</head>
<body>

<header>Forumate
  <button id="adminBtn" onclick="showAdminLogin()">A</button>
</header>

<div id="hamburger" onclick="toggleSidebar()">☰</div>
<div id="sidebar">
  <button onclick="showBugForm()">Report a Bug</button>
  <button id="seeBugsBtn" onclick="viewBugs()" style="display:none;">See Bugs</button>
  <button class="closeBtn" onclick="toggleSidebar()">×</button>
</div>

<div id="loginPopup" style="display:none;">
  <div>
    <button class="closeBtn" onclick="closeAdminLogin()">×</button>
    <h3>Admin Login</h3>
    <input id="loginName" placeholder="Username">
    <input id="loginPass" type="password" placeholder="Password">
    <button onclick="loginAdmin()">Login</button>
  </div>
</div>

<div id="adminPanel" style="display:none;">
  <button onclick="adminReset()">Reset All Posts</button>
  <button onclick="createPinnedPost()">Make Pinned Post</button>
</div>

<main>
  <button id="backBtn" onclick="backToPosts()">&lt; Back</button>
  <input type="text" id="name" placeholder="Your name">
  <textarea id="message" placeholder="Your message" rows="3"></textarea>
  <input type="text" id="image" placeholder="Image URL (optional)">
  <button id="postBtn" onclick="postMessage()">Post</button>
  <button id="reportBugBtn" style="display:none;" onclick="submitBug()">Submit Bug</button>
  <div id="posts"></div>
</main>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyA1pylg4PQS_hXhKiLvYcdgh5jbLYhME40",
  authDomain: "html-test-forum.firebaseapp.com",
  databaseURL: "https://html-test-forum-default-rtdb.firebaseio.com",
  projectId: "html-test-forum",
  storageBucket: "html-test-forum.firebasestorage.app",
  messagingSenderId: "781492084495",
  appId: "1:781492084495:web:309c83e29024ba321ba87a",
  measurementId: "G-H877ZK81ZM"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();
const postsDiv=document.getElementById('posts');
let isAdmin=false;
let viewingBugs=false;

// Sidebar toggle
function toggleSidebar(){
  const sb=document.getElementById('sidebar');
  if(sb.style.left=='0px'){ sb.style.left='-250px'; } else{ sb.style.left='0px'; }
  document.querySelector('main').style.marginLeft=(sb.style.left=='0px')?'250px':'0px';
}

// Admin login
function showAdminLogin() {
  document.getElementById('loginPopup').style.display='flex';
  const lastUser = localStorage.getItem('lastAdminUser');
  if(lastUser) document.getElementById('loginName').value = lastUser;
}
function closeAdminLogin() {
  document.getElementById('loginPopup').style.display='none';
}
function loginAdmin(){
  const user = document.getElementById('loginName').value.trim();
  const pass = document.getElementById('loginPass').value.trim();
  localStorage.setItem('lastAdminUser', user);
  if(user==='melting' && pass==='melting'){
    isAdmin=true;
    document.getElementById('loginPopup').style.display='none';
    document.getElementById('seeBugsBtn').style.display='block';
    alert('Admin logged in!');
  }else{ alert('Wrong credentials'); }
}

// Posting
function postMessage(){
  const name=document.getElementById('name').value.trim();
  const message=document.getElementById('message').value.trim();
  const image=document.getElementById('image').value.trim();
  if(!name||!message) return alert('Name and message required');
  const timestamp=new Date().toLocaleString();
  const post={name,message,timestamp};
  if(image) post.image=image;
  if(isAdmin){ post.admin=true; post.name='OWNER'; }
  db.ref('posts').push(post);
  document.getElementById('name').value='';
  document.getElementById('message').value='';
  document.getElementById('image').value='';
}

// Bug reporting
function showBugForm(){
  viewingBugs=false;
  document.getElementById('backBtn').style.display='none';
  document.getElementById('postBtn').style.display='none';
  document.getElementById('reportBugBtn').style.display='block';
  document.getElementById('posts').innerHTML='';
}

function submitBug(){
  const message=document.getElementById('message').value.trim();
  if(!message) return alert('Bug description required');
  const timestamp=new Date().toLocaleString();
  db.ref('bugs').push({message,timestamp});
  alert('Bug submitted!');
  document.getElementById('message').value='';
}

// View bugs for admin
function viewBugs(){
  if(!isAdmin) return alert('Admin only');
  viewingBugs=true;
  document.getElementById('posts').innerHTML='';
  document.getElementById('backBtn').style.display='block';
  document.getElementById('postBtn').style.display='none';
  document.getElementById('reportBugBtn').style.display='none';
  db.ref('bugs').on('value',snapshot=>{
    const div=document.getElementById('posts');
    div.innerHTML='';
    snapshot.forEach(child=>{
      const bug=child.val();
      const d=document.createElement('div');
      d.className='post';
      d.innerHTML=`<div class="message">${bug.message}</div><div class="timestamp">${bug.timestamp}</div>`;
      div.prepend(d);
    });
  });
}

function backToPosts(){
  viewingBugs=false;
  document.getElementById('backBtn').style.display='none';
  document.getElementById('postBtn').style.display='block';
  document.getElementById('reportBugBtn').style.display='none';
  loadPosts();
}

// Admin controls
function adminReset(){ if(confirm("Reset all posts?")) db.ref('posts').remove(); }
function createPinnedPost(){ const msg=prompt("Pinned post message:"); if(!msg) return; const timestamp=new Date().toLocaleString(); db.ref('posts').push({name:'OWNER',message:msg,timestamp,admin:true,pinned:true}); }
function removePost(key){ if(confirm('Delete this post?')) db.ref('posts/'+key).remove(); }

// Load posts
function loadPosts(){
  db.ref('posts').on('value', snapshot=>{
    if(viewingBugs) return;
    postsDiv.innerHTML='';
    snapshot.forEach(child=>{
      const data=child.val();
      const div=document.createElement('div');
      div.className='post';
      if(data.pinned) div.classList.add('pinned');
      let nameClass=(data.admin)?'name owner':'name';
      let menu=isAdmin?`<span class="postMenuBtn" onclick="removePost('${child.key}')">⋮</span>`:'';
      let img=data.image?`<img src="${data.image}">`:'';
      div.innerHTML=`<div class="${nameClass}">${data.name}${menu}</div><div class="message">${data.message}</div>${img}<div class="timestamp">${data.timestamp}</div>`;
      postsDiv.prepend(div);
    });
  });
}
loadPosts();
</script>

</body>
</html>
